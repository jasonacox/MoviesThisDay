<!-- details.html: Movie details page for MoviesThisDay -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ movie.title }} | MoviesThisDay</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #f3f6fa; }
    .header-bar {
      font-size: 1.15rem;
      background: linear-gradient(90deg, #2563eb 0%, #60a5fa 100%);
      color: #fff;
      padding: 14px 0 12px 0;
      margin-bottom: 0;
      z-index: 1100;
      box-shadow: 0 2px 8px rgba(30,41,59,0.07);
    }
    .header-bar span { font-weight: 600; letter-spacing: 0.5px; }
    .header-bar .tagline { font-size: 0.97rem; color: #e0e7ef; }
    .footer {
      background: linear-gradient(90deg, #2563eb 0%, #60a5fa 100%);
      color: #fff;
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      z-index: 1000;
      box-shadow: 0 -2px 8px rgba(30,41,59,0.07);
      border-bottom: none;
      margin-bottom: 0 !important;
      padding-bottom: 0 !important;
      margin-top: 0 !important;
      padding-top: 12px !important;
      padding-bottom: 12px !important;
    }
    .footer a { color: #e0e7ef; text-decoration: underline; }
    .movie-card {
      max-width: 700px;
      margin: 2rem auto;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 24px rgba(30,41,59,0.08);
      padding: 32px 28px 24px 28px;
    }
    .movie-title { font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem; }
    .movie-meta { color: #2563eb; font-size: 1.1rem; margin-bottom: 1.2rem; }
    .movie-label { font-weight: 600; color: #2563eb; }
    .movie-value { color: #22223b; }
    .movie-section { margin-bottom: 1.2rem; }
    .movie-section:last-child { margin-bottom: 0; }
    .imdb-link { color: #f5c518; font-weight: 600; }
    .back-link { color: #2563eb; text-decoration: underline; font-weight: 500; }
  </style>
</head>
<body>
  <div class="header-bar fixed-top d-flex align-items-center justify-content-between px-3">
    <div class="d-flex align-items-center">
      <a href="/" style="text-decoration:none; color:inherit;"><span style="font-size:1.25rem; font-weight:700; letter-spacing:0.5px;">MoviesThisDay</span></a>
      <span class="ms-2 tagline d-none d-md-inline">Discover movies released on this day in history</span>
    </div>
    <nav class="d-flex align-items-center ms-auto">
      <a class="nav-link d-inline px-2" href="/">Home</a>
      <a class="nav-link d-inline px-2" href="/about">About</a>
      <a class="nav-link d-inline px-2" href="/search">Search</a>
    </nav>
  </div>
  <div class="container" style="padding-top:80px;">
    <div class="movie-card d-flex flex-row">
      <div class="flex-grow-1" style="min-width:0;">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <div class="movie-title">{{ movie.title }} {% if movie.release_year %}({{ movie.release_year }}){% endif %}</div>
        </div>
        <div class="movie-section"><span class="movie-label">Released:</span> <span class="movie-value">

          {% if movie.release_date %}{{ movie.release_date }}{% endif %}
        </span></div>
        <div class="movie-section"><span class="movie-label">Runtime:</span> <span class="movie-value">{% if movie.runtime %}{{ movie.runtime }} min{% else %}-{% endif %}</span></div>
        <div class="movie-section"><span class="movie-label">Popularity:</span> <span class="movie-value">{{ movie.popularity }} | Vote Avg {{ movie.vote_average or '-' }} | Count: {{ movie.vote_count or '-' }} </span></div>
        <div class="movie-section"><span class="movie-label">Genres:</span> <span class="movie-value">{{ movie.omdb_genre or '-' }}</span></div>
        <div class="movie-section"><span class="movie-label">Studio:</span> <span class="movie-value">{{ movie.production_companies or '-' }}</span></div>
        <div class="movie-section"><span class="movie-label">IMDB:</span>
          <span class="movie-value"> ID: 
            {% if movie.imdb_id %}
              <a class="imdb-link" href="https://www.imdb.com/title/{{ movie.imdb_id }}" target="_blank">{{ movie.imdb_id }}</a>
            {% else %}
              -
            {% endif %}
            {% if movie.omdb_imdb_rating or movie.omdb_imdb_votes %}
              &nbsp;| Rating: {{ movie.omdb_imdb_rating or '-' }}
              &nbsp;| Votes: {{ movie.omdb_imdb_votes or '-' }}
            {% endif %}
          </span>
        </div>
        <div class="movie-section"><span class="movie-label">TMDB ID:</span> <span class="movie-value">{{ movie.id or '-' }}</span></div>
        <div class="movie-section"><span class="movie-label">Release Date:</span> <span class="movie-value">{{ movie.release_date or '-' }}</span></div>
        <div class="movie-section"><span class="movie-label">Language:</span> <span class="movie-value">{{ movie.language or '-' }} | Original {{ movie.original_language or '-' }}</span></div>
        <div class="movie-section"><span class="movie-label">Box Office:</span> <span class="movie-value">{{ movie.omdb_box_office or '-' }}</span></div>
        <div class="mt-4" style="max-width:500px; margin:auto;">
          <form id="correctionForm" onsubmit="submitCorrection(); return false;">
            <input type="hidden" id="correctionImdbId" value="{{ movie.imdb_id }}">
            <input type="hidden" id="correctionMovieTitle" value="{{ movie.title }}">
            <label for="correctionInput" class="form-label" style="color:#2563eb; font-weight:500;">See an error? Suggest a correction:</label>
            <div class="input-group mb-2">
              <input type="text" id="correctionInput" class="form-control" placeholder="Describe the correction (e.g. release date)" required>
              <button class="btn btn-outline-primary" type="submit">Submit</button>
            </div>
            <div id="correctionMsg" style="font-size:0.95em; color:#198754;"></div>
          </form>
        </div>
        <div class="mt-4">
          <a href="javascript:history.back()" class="back-link">&larr; Back</a>
        </div>
      </div>
      {% if movie.omdb_poster %}
      <div class="ms-4 d-none d-md-block" style="min-width:120px; max-width:180px; align-self:flex-start; margin-top:40px;">
        <img src="{{ movie.omdb_poster }}" alt="Poster" style="width:100%; max-width:180px; border-radius:8px; box-shadow:0 2px 12px rgba(30,41,59,0.10);">
      </div>
      {% endif %}
    </div>
  </div>
  <div class="footer text-center" style="font-size:0.95rem;">
    Powered by <a href="https://github.com/jasonacox/MoviesThisDay" target="_blank">MoviesThisDay</a> | Version: {{ version }}
  </div>
  <script>
    function submitCorrection() {
      const input = document.getElementById('correctionInput');
      const imdbId = document.getElementById('correctionImdbId').value;
      const movieTitle = document.getElementById('correctionMovieTitle').value;
      const msg = document.getElementById('correctionMsg');
      const value = input.value.trim();
      const submitBtn = document.querySelector('#correctionForm button[type="submit"]');
      if (!value) return;
      const formData = new FormData();
      formData.append('imdb_id', imdbId);
      formData.append('movie_title', movieTitle);
      formData.append('correction', value);
      formData.append('user_agent', navigator.userAgent);
      // Disable submit button and turn it gray
      submitBtn.disabled = true;
      submitBtn.classList.add('btn-secondary');
      submitBtn.classList.remove('btn-outline-primary');
      fetch('/corrections', {
        method: 'POST',
        body: formData
      })
      .then(r => r.text())
      .then(text => {
        msg.textContent = text;
        if (text.startsWith('Oops')) {
          msg.style.color = '#dc3545';
          msg.style.fontWeight = 'bold';
        } else {
          msg.style.color = '#198754';
          msg.style.fontWeight = 'normal';
        }
        input.value = '';
        setTimeout(() => { msg.textContent = ''; }, 4000);
      })
      .catch(() => {
        msg.textContent = 'Error submitting correction.';
        msg.style.color = '#dc3545';
      })
      .finally(() => {
        // Re-enable submit button and restore style
        submitBtn.disabled = false;
        submitBtn.classList.remove('btn-secondary');
        submitBtn.classList.add('btn-outline-primary');
      });
    }
  </script>
</body>
</html>
